

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Project: Recognizing digits with k-NN &mdash; MTH 448/548  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  
    <link rel="canonical" href="https://www.mth548.org/Projects/mnist_with_knn/mnist_with_knn.html" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Project: MNIST with k-means" href="../mnist_with_k_means/mnist_with_k_means.html" />
    <link rel="prev" title="SQL with Python" href="../../Tools/SQL/sql_with_python.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../master.html" class="icon icon-home"> MTH 448/548
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Logistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">MTH 448/548 Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../to_do.html">Current Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../report_guide.html">Project Report Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../useful_links.html">Useful links</a></li>
</ul>
<p><span class="caption-text">Schedule</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Schedule/week_0.html">Preliminaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Schedule/week_1.html">Week 1 (1/31-2/6)</a></li>
</ul>
<p><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Tools/Numpy/numpy_toc.html">Numpy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../master.html">MTH 448/548</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../master.html">MTH 448/548</a> &raquo;</li>
        
      <li>Project: Recognizing digits with k-NN</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Project:-Recognizing-digits-with-k-NN">
<h1>Project: Recognizing digits with k-NN<a class="headerlink" href="#Project:-Recognizing-digits-with-k-NN" title="Permalink to this headline">¶</a></h1>
<html><h1 style="color:teal;"><p>Project weight: 10 points</p>
</h1></html><section id="MNIST-database">
<h2>MNIST database<a class="headerlink" href="#MNIST-database" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://yann.lecun.com/exdb/mnist/">MNIST database</a> is a collection of 60,000 images of handwritten digits from 0 through 9, with numerical labels. Here is sample of images included in the database:</p>
<img alt="MNIST digits" src="../../_images/digits.png" />
</section>
<section id="Objectives">
<h2>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h2>
<p><strong>Part 1.</strong> Write a function <code class="docutils literal notranslate"><span class="pre">knn()</span></code> which emplements the k-NN algorithm. This function should take four arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">training_data</span></code> - a 2-dimensional numpy array whose each row is one element of the training data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">training_labels</span></code> - a 1-dimensional numpy array with labels of the training data: the <span class="math notranslate nohighlight">\(k\)</span>-th element of this array is the label corresponding to the <span class="math notranslate nohighlight">\(k\)</span>-th row of <code class="docutils literal notranslate"><span class="pre">training_data</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - a 1-dimensional numpy array with a data point we want to classify.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer specifying the number of neighbors to use for the classification.</p></li>
</ul>
<p>The function should return a tuple <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">neighbors)</span></code>, where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> is the predicted label of the point <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighbors</span></code> is a list of rows numbers of <code class="docutils literal notranslate"><span class="pre">training_data</span></code> which are the <span class="math notranslate nohighlight">\(n\)</span> nearest neighbors of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
<p><strong>Note.</strong> You need to implement the k-NN algorithm from scratch, using only Python and numpy. Do not use libraries which have this algorithm already implemented.</p>
<p><strong>Part 2.</strong> Download MNIST files for this project:</p>
<div class="line-block">
<div class="line"><a class="reference download external" download="" href="http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz"><code class="xref download docutils literal notranslate"><span class="pre">train-images-idx3-ubyte.gz</span></code></a></div>
<div class="line"><a class="reference download external" download="" href="http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz"><code class="xref download docutils literal notranslate"><span class="pre">train-labels-idx1-ubyte.gz</span></code></a></div>
</div>
<p>The first file contains images of digits and the second the corresponding labels. The format of both files is described on the <a class="reference external" href="http://yann.lecun.com/exdb/mnist/">MNIST database website</a>.</p>
<p>Investigate performance of the k-Nearest Neighbors algorithm in classification of images in the MNIST database, and describe your results.</p>
<p>Here are some questions which you may consider:</p>
<ul class="simple">
<li><p>How does classification accuracy depend on the size of the training set and the number of neighbors?</p></li>
<li><p>Various ways of measuring distances between images, and their impact on classification.</p></li>
<li><p>You can consider a weighted k-NN algorithm: instead of just counting how many neighbors of a point have a given label, assign a weight to each neighbor depending on its distance from the data point being classified (smaller weights for more distant neighbors). Then classify the point depending on the sum of weights of neighbors with a given label. Does this improve the accuracy?</p></li>
<li><p>Analyze examples of images that have not been classified correctly. What went wrong with them? Which digits are confused most often with what other digits?</p></li>
<li><p>What fraction of images was correctly classified with perfect certainty, i.e. the images were classified correctly, and all their neighbors had the same label?</p></li>
<li><p>Were there any images for which no neighbor had the correct label? Or even all neighbors had the same but incorrect label?</p></li>
<li><p>Anything else you find interesting.</p></li>
</ul>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../mnist_with_k_means/mnist_with_k_means.html" class="btn btn-neutral float-right" title="Project: MNIST with k-means" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../Tools/SQL/sql_with_python.html" class="btn btn-neutral float-left" title="SQL with Python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width: 100px; border-width:0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg" /></a>  <a href="mailto:admin@mth548.org">Bernard Badzioch</a>
      <span class="lastupdated"><br/>
        Last updated on Dec 22, 2021.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-161474487-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>