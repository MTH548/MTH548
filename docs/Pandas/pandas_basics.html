

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pandas basics &mdash; MTH 448/548 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reshaping DataFrames" href="reshaping_dataframes.html" />
    <link rel="prev" title="Pandas" href="pandas_toc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MTH 448/548
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../report_guide.html">Project Report Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../useful_links.html">Useful links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Numpy/numpy_toc.html">Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mnist_with_knn/mnist_with_knn.html">Project: Recognizing digits with k-NN</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="pandas_toc.html">Pandas</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pandas basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Pandas-Series">Pandas Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Pandas-DataFrame">Pandas DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Selecting-data-in-a-DataFrame">Selecting data in a DataFrame</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Basic-selections">Basic selections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Selections-with-loc-and-iloc">Selections with <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">iloc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Boolean-indexing">Boolean indexing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Sorting">Sorting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Modifying-DataFrames-and-Series">Modifying DataFrames and Series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adding-rows-and-columns">Adding rows and columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Using-numpy-functions">Using numpy functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Series.apply()">Series.apply()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Aggregations">Aggregations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#DataFrame.agg()">DataFrame.agg()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reshaping_dataframes.html">Reshaping DataFrames</a></li>
<li class="toctree-l2"><a class="reference internal" href="groupby.html">GroupBy</a></li>
<li class="toctree-l2"><a class="reference internal" href="combining_dataframes.html">Combining DataFrames</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Plotly/plotly_toc.html">Plotly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../baby_names/baby_names.html">Project: Baby names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Regex/regex_toc.html">Regular expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requests.html">Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beautiful_soup.html">Beautiful Soup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scrapping_course_listings/scrapping_course_listings.html">Scrapping course listings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../json.html">JSON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../escape_from_jupyter.html">Escape from Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nhtsa_complaints.html">NHTSA complaints database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SQL/sql_toc.html">SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PT-functions.html">Functions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MTH 448/548</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">MTH548</a> &raquo;</li>
        
          <li><a href="pandas_toc.html">Pandas</a> &raquo;</li>
        
      <li>Pandas basics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/MTH548/MTH548_site/blob/master/source/Pandas/pandas_basics.ipynb" class="fa fa-github"> View on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Pandas-basics">
<h1>Pandas basics<a class="headerlink" href="#Pandas-basics" title="Permalink to this headline">¶</a></h1>
<p>Pandas is a Python library for working with tabular data. The main objects it provides are Series and DataFrame.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="section" id="Pandas-Series">
<h2>Pandas Series<a class="headerlink" href="#Pandas-Series" title="Permalink to this headline">¶</a></h2>
<p>Pandas Series is essentially a one-dimensional array, equipped with an index which labels its entries. We can create a Series object, for example, by converting a list:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4879</span><span class="p">,</span> <span class="mi">12104</span><span class="p">,</span> <span class="mi">12756</span><span class="p">,</span> <span class="mi">6792</span><span class="p">,</span> <span class="mi">142984</span><span class="p">,</span> <span class="mi">120536</span><span class="p">,</span> <span class="mi">51118</span><span class="p">,</span> <span class="mi">49528</span><span class="p">])</span>
<span class="n">diameters</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0      4879
1     12104
2     12756
3      6792
4    142984
5    120536
6     51118
7     49528
dtype: int64
</pre></div></div>
</div>
<p>By default entries of a Series are indexed by consecutive integers, but we can specify a more meaningful index. The numbers in the above Series give diameters (in kilometers) of planets of the Solar System, so it is sensible to use names of the planet as index values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4879</span><span class="p">,</span> <span class="mi">12104</span><span class="p">,</span> <span class="mi">12756</span><span class="p">,</span> <span class="mi">6792</span><span class="p">,</span> <span class="mi">142984</span><span class="p">,</span> <span class="mi">120536</span><span class="p">,</span> <span class="mi">51118</span><span class="p">,</span> <span class="mi">49528</span><span class="p">],</span>
                      <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Mercury&quot;</span><span class="p">,</span> <span class="s2">&quot;Venus&quot;</span><span class="p">,</span> <span class="s2">&quot;Earth&quot;</span><span class="p">,</span> <span class="s2">&quot;Mars&quot;</span><span class="p">,</span> <span class="s2">&quot;Jupyter&quot;</span><span class="p">,</span> <span class="s2">&quot;Saturn&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Uranus&quot;</span><span class="p">,</span> <span class="s2">&quot;Neptune&quot;</span><span class="p">])</span>
<span class="n">diameters</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury      4879
Venus       12104
Earth       12756
Mars         6792
Jupyter    142984
Saturn     120536
Uranus      51118
Neptune     49528
dtype: int64
</pre></div></div>
</div>
<p>We can use index values to select Series entries:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span><span class="p">[</span><span class="s2">&quot;Earth&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
12756
</pre></div></div>
</div>
<p>Slicing using index works as well:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span><span class="p">[</span><span class="s2">&quot;Mercury&quot;</span><span class="p">:</span><span class="s2">&quot;Mars&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury     4879
Venus      12104
Earth      12756
Mars        6792
dtype: int64
</pre></div></div>
</div>
<p><strong>Note.</strong> In pandas slicing with index values works a bit differently that slicing in Python in general: the code <code class="docutils literal notranslate"><span class="pre">diameters[&quot;Mercury&quot;:&quot;Mars&quot;]</span></code> selects all entries from <code class="docutils literal notranslate"><span class="pre">&quot;Mercury&quot;</span></code> up to <strong>and including</strong> <code class="docutils literal notranslate"><span class="pre">&quot;Mars&quot;</span></code>.</p>
<p>We can also select Series values by specifying a list of index labels:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span><span class="p">[[</span><span class="s2">&quot;Earth&quot;</span><span class="p">,</span> <span class="s2">&quot;Jupyter&quot;</span><span class="p">,</span> <span class="s2">&quot;Neptune&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Earth       12756
Jupyter    142984
Neptune     49528
dtype: int64
</pre></div></div>
</div>
<p>Indexing can be used to modify Series values or to add new values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span><span class="p">[</span><span class="s2">&quot;Pluto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2370</span>
<span class="n">diameters</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury      4879
Venus       12104
Earth       12756
Mars         6792
Jupyter    142984
Saturn     120536
Uranus      51118
Neptune     49528
Pluto        2370
dtype: int64
</pre></div></div>
</div>
</div>
<div class="section" id="Pandas-DataFrame">
<h2>Pandas DataFrame<a class="headerlink" href="#Pandas-DataFrame" title="Permalink to this headline">¶</a></h2>
<p>Pandas DataFrame is a two-dimensional array equipped with one index labeling its rows, and another labeling its columns. There are several ways of creating a DataFrame. One of them is to use a dictionary of lists. Each list gives values of a column of the DataFrame, and dictionary keys give column labels:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;diameter&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4879</span><span class="p">,</span> <span class="mi">12104</span><span class="p">,</span> <span class="mi">12756</span><span class="p">,</span> <span class="mi">6792</span><span class="p">,</span> <span class="mi">142984</span><span class="p">,</span> <span class="mi">120536</span><span class="p">,</span> <span class="mi">51118</span><span class="p">,</span> <span class="mi">49528</span><span class="p">,</span> <span class="mi">2370</span><span class="p">],</span>
     <span class="s2">&quot;avg_temp&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">167</span><span class="p">,</span> <span class="mi">464</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">65</span><span class="p">,</span> <span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="o">-</span><span class="mi">140</span><span class="p">,</span> <span class="o">-</span><span class="mi">195</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">225</span><span class="p">],</span>
     <span class="s2">&quot;gravity&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">3.7</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">,</span> <span class="mf">9.8</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">,</span> <span class="mf">23.1</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">8.7</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]}</span>

<span class="n">planets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>51118</td>
      <td>-195</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">head</span></code> and <code class="docutils literal notranslate"><span class="pre">tail</span></code> methods lets us select the first snd last few rows of a DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># get the first 3 rows</span>
<span class="n">planets</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># get the last 2 rows</span>
<span class="n">planets</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Index of DataFrame columns can be accessed using the <code class="docutils literal notranslate"><span class="pre">columns</span></code> property:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;diameter&#39;, &#39;avg_temp&#39;, &#39;gravity&#39;], dtype=&#39;object&#39;)
</pre></div></div>
</div>
<p>Index of rows can be obtained using the <code class="docutils literal notranslate"><span class="pre">index</span></code> property:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RangeIndex(start=0, stop=9, step=1)
</pre></div></div>
</div>
<p>Since we have not specified an index for rows, by default it consists of consecutive integers. We can change it by modifying the index:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mercury&quot;</span><span class="p">,</span> <span class="s2">&quot;Venus&quot;</span><span class="p">,</span> <span class="s2">&quot;Earth&quot;</span><span class="p">,</span> <span class="s2">&quot;Mars&quot;</span><span class="p">,</span> <span class="s2">&quot;Jupyter&quot;</span><span class="p">,</span> <span class="s2">&quot;Saturn&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Uranus&quot;</span><span class="p">,</span> <span class="s2">&quot;Neptune&quot;</span><span class="p">,</span> <span class="s2">&quot;Pluto&quot;</span><span class="p">]</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118</td>
      <td>-195</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;Mercury&#39;, &#39;Venus&#39;, &#39;Earth&#39;, &#39;Mars&#39;, &#39;Jupyter&#39;, &#39;Saturn&#39;, &#39;Uranus&#39;,
       &#39;Neptune&#39;, &#39;Pluto&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
</div>
<div class="section" id="Selecting-data-in-a-DataFrame">
<h2>Selecting data in a DataFrame<a class="headerlink" href="#Selecting-data-in-a-DataFrame" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Basic-selections">
<h3>Basic selections<a class="headerlink" href="#Basic-selections" title="Permalink to this headline">¶</a></h3>
<p>Columns of a DataFrame can be selected by specifying a column name. This returns a Series with column data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;gravity&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury     3.7
Venus       8.9
Earth       9.8
Mars        3.7
Jupyter    23.1
Saturn      9.0
Uranus      8.7
Neptune    11.0
Pluto       0.7
Name: gravity, dtype: float64
</pre></div></div>
</div>
<p>Specifying a list of column names gives a DataFrame consisting of the selected columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="p">[[</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span> <span class="s2">&quot;diameter&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gravity</th>
      <th>diameter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>3.7</td>
      <td>4879</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>8.9</td>
      <td>12104</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>9.8</td>
      <td>12756</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>3.7</td>
      <td>6792</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>23.1</td>
      <td>142984</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>9.0</td>
      <td>120536</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>8.7</td>
      <td>51118</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>11.0</td>
      <td>49528</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>0.7</td>
      <td>2370</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Slicing selects rows of a DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;Earth&quot;</span><span class="p">:</span><span class="s2">&quot;Saturn&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Selections-with-loc-and-iloc">
<h3>Selections with <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">iloc</span></code><a class="headerlink" href="#Selections-with-loc-and-iloc" title="Permalink to this headline">¶</a></h3>
<p>To get more flexibility with DataFrame selections we can use the <code class="docutils literal notranslate"><span class="pre">loc</span></code> indexer. It lets us select rows and columns using row and column labels, lists of labels, and slices:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select an entry in a given row and column</span>
<span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Earth&quot;</span><span class="p">,</span> <span class="s2">&quot;gravity&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
9.8
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select one row and a list of columns</span>
<span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Earth&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;diameter&quot;</span><span class="p">,</span> <span class="s2">&quot;gravity&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
diameter    12756.0
gravity         9.8
Name: Earth, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select a slice of rows and a list of columns</span>
<span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Earth&quot;</span><span class="p">:</span><span class="s2">&quot;Saturn&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span> <span class="s2">&quot;avg_temp&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gravity</th>
      <th>avg_temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Earth</th>
      <td>9.8</td>
      <td>15</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>3.7</td>
      <td>-65</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>23.1</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>9.0</td>
      <td>-140</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">iloc</span></code> indexer works similarly, but it uses row and column numbers instead of their labels:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select the first 3 rows</span>
<span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select all rows and the first 2 columns</span>
<span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118</td>
      <td>-195</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528</td>
      <td>-200</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370</td>
      <td>-225</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select using a list of row numbers and a slice of column numbers</span>
<span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>167</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>-110</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>-140</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">loc</span></code> snd <code class="docutils literal notranslate"><span class="pre">iloc</span></code> work with pandas Series too:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury      4879
Venus       12104
Earth       12756
Mars         6792
Jupyter    142984
Saturn     120536
Uranus      51118
Neptune     49528
Pluto        2370
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># loc with pandas Series</span>
<span class="n">diameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Jupyter&quot;</span><span class="p">:</span><span class="s2">&quot;Pluto&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Jupyter    142984
Saturn     120536
Uranus      51118
Neptune     49528
Pluto        2370
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># iloc with pandas Series</span>
<span class="n">diameters</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury      4879
Venus       12104
Saturn     120536
dtype: int64
</pre></div></div>
</div>
</div>
<div class="section" id="Boolean-indexing">
<h3>Boolean indexing<a class="headerlink" href="#Boolean-indexing" title="Permalink to this headline">¶</a></h3>
<p>Similarly as with numpy arrays, we can use Boolean indexing to select parts of pandas Series and DataFrames.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118</td>
      <td>-195</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># check which planets have diameter greater than 100,000 km</span>
<span class="n">planets</span><span class="p">[</span><span class="s2">&quot;diameter&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100000</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury    False
Venus      False
Earth      False
Mars       False
Jupyter     True
Saturn      True
Uranus     False
Neptune    False
Pluto      False
Name: diameter, dtype: bool
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select all planets with diameter greater than 100,000 km</span>
<span class="n">planets</span><span class="p">[</span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;diameter&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Notice that if the Boolean array used for selection is one-dimensional, then is selects rows of the DataFrame. Other options (using a two-dimensional Boolean array, using a one-dimensional array to select columns) are also possible.</p>
<p>Logical conditions can be combined the same way as for numpy arrays:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># select planets based on their average temperatue and gravity</span>
<span class="n">planets</span><span class="p">[(</span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;avg_temp&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;gravity&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="Sorting">
<h2>Sorting<a class="headerlink" href="#Sorting" title="Permalink to this headline">¶</a></h2>
<p>Values of pandas Series can be sorted using the <code class="docutils literal notranslate"><span class="pre">sort_values</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury      4879
Venus       12104
Earth       12756
Mars         6792
Jupyter    142984
Saturn     120536
Uranus      51118
Neptune     49528
Pluto        2370
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sort values in ascending order</span>
<span class="n">diameters</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Pluto        2370
Mercury      4879
Mars         6792
Venus       12104
Earth       12756
Neptune     49528
Uranus      51118
Saturn     120536
Jupyter    142984
dtype: int64
</pre></div></div>
</div>
<p>By default values are sorted in the ascending order, but we can change it:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sort values in descending order</span>
<span class="n">diameters</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Jupyter    142984
Saturn     120536
Uranus      51118
Neptune     49528
Earth       12756
Venus       12104
Mars         6792
Mercury      4879
Pluto        2370
dtype: int64
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sort_values</span></code> works with DataFrames as well, but in this case we need to specify which column (or row) should be used for sorting:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sort using the &quot;diameter&quot; column</span>
<span class="n">planets</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;diameter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Pluto</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
    </tr>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118</td>
      <td>-195</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sort using the &quot;gravity&quot; column in descending order</span>
<span class="n">planets</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118</td>
      <td>-195</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sort_values</span></code> method accepts <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument. The default value is <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> which sorts columns. By changing it to <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> we can sort rows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sort values in the &quot;Mercury&quot; row</span>
<span class="n">planets</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Mercury&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gravity</th>
      <th>avg_temp</th>
      <th>diameter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>3.7</td>
      <td>167</td>
      <td>4879</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>8.9</td>
      <td>464</td>
      <td>12104</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>9.8</td>
      <td>15</td>
      <td>12756</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>3.7</td>
      <td>-65</td>
      <td>6792</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>23.1</td>
      <td>-110</td>
      <td>142984</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>9.0</td>
      <td>-140</td>
      <td>120536</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>8.7</td>
      <td>-195</td>
      <td>51118</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>11.0</td>
      <td>-200</td>
      <td>49528</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>0.7</td>
      <td>-225</td>
      <td>2370</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The mathod <code class="docutils literal notranslate"><span class="pre">sort_index</span></code> allows us to sort a DataFrame according to the index of its rows or columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sort row index</span>
<span class="n">planets</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118</td>
      <td>-195</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sort column index</span>
<span class="n">planets</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_temp</th>
      <th>diameter</th>
      <th>gravity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>167</td>
      <td>4879</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>464</td>
      <td>12104</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>15</td>
      <td>12756</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>-65</td>
      <td>6792</td>
      <td>3.7</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>-110</td>
      <td>142984</td>
      <td>23.1</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>-140</td>
      <td>120536</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>-195</td>
      <td>51118</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>-200</td>
      <td>49528</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>-225</td>
      <td>2370</td>
      <td>0.7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Modifying-DataFrames-and-Series">
<h2>Modifying DataFrames and Series<a class="headerlink" href="#Modifying-DataFrames-and-Series" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Adding-rows-and-columns">
<h3>Adding rows and columns<a class="headerlink" href="#Adding-rows-and-columns" title="Permalink to this headline">¶</a></h3>
<p>We can add a column to a DataFrame by specifying its name and values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;moons&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
      <th>moons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879</td>
      <td>167</td>
      <td>3.7</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104</td>
      <td>464</td>
      <td>8.9</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756</td>
      <td>15</td>
      <td>9.8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792</td>
      <td>-65</td>
      <td>3.7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984</td>
      <td>-110</td>
      <td>23.1</td>
      <td>79</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536</td>
      <td>-140</td>
      <td>9.0</td>
      <td>82</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118</td>
      <td>-195</td>
      <td>8.7</td>
      <td>27</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528</td>
      <td>-200</td>
      <td>11.0</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370</td>
      <td>-225</td>
      <td>0.7</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Rows can be added in a similar way:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Moon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3475</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
      <th>moons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879.0</td>
      <td>167.0</td>
      <td>3.7</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104.0</td>
      <td>464.0</td>
      <td>8.9</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756.0</td>
      <td>15.0</td>
      <td>9.8</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792.0</td>
      <td>-65.0</td>
      <td>3.7</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984.0</td>
      <td>-110.0</td>
      <td>23.1</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536.0</td>
      <td>-140.0</td>
      <td>9.0</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118.0</td>
      <td>-195.0</td>
      <td>8.7</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528.0</td>
      <td>-200.0</td>
      <td>11.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370.0</td>
      <td>-225.0</td>
      <td>0.7</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Moon</th>
      <td>3475.0</td>
      <td>-20.0</td>
      <td>1.6</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>New columns can be created based on the values of existing columns. For example, in the <code class="docutils literal notranslate"><span class="pre">planets</span></code> DataFrame the column <code class="docutils literal notranslate"><span class="pre">avg_temp</span></code> gives temperatures in degrees Celsius. We can add a new column with temperatures in degrees Fahrenheit:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;avg_temp_F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">planets</span><span class="p">[</span><span class="s2">&quot;avg_temp&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.8</span> <span class="o">+</span> <span class="mi">32</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>gravity</th>
      <th>moons</th>
      <th>avg_temp_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879.0</td>
      <td>167.0</td>
      <td>3.7</td>
      <td>0.0</td>
      <td>332.6</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104.0</td>
      <td>464.0</td>
      <td>8.9</td>
      <td>0.0</td>
      <td>867.2</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756.0</td>
      <td>15.0</td>
      <td>9.8</td>
      <td>1.0</td>
      <td>59.0</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792.0</td>
      <td>-65.0</td>
      <td>3.7</td>
      <td>2.0</td>
      <td>-85.0</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984.0</td>
      <td>-110.0</td>
      <td>23.1</td>
      <td>79.0</td>
      <td>-166.0</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536.0</td>
      <td>-140.0</td>
      <td>9.0</td>
      <td>82.0</td>
      <td>-220.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118.0</td>
      <td>-195.0</td>
      <td>8.7</td>
      <td>27.0</td>
      <td>-319.0</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528.0</td>
      <td>-200.0</td>
      <td>11.0</td>
      <td>14.0</td>
      <td>-328.0</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370.0</td>
      <td>-225.0</td>
      <td>0.7</td>
      <td>5.0</td>
      <td>-373.0</td>
    </tr>
    <tr>
      <th>Moon</th>
      <td>3475.0</td>
      <td>-20.0</td>
      <td>1.6</td>
      <td>0.0</td>
      <td>-4.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>By default a new column is added as the last column of a DataFrame. However, we can rearrange columns, by selecting them in any given order:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># make a copy of the DataFrame with rearranged columns</span>
<span class="n">planets</span> <span class="o">=</span> <span class="n">planets</span><span class="p">[[</span><span class="s1">&#39;diameter&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_temp_F&#39;</span><span class="p">,</span> <span class="s1">&#39;gravity&#39;</span><span class="p">,</span> <span class="s1">&#39;moons&#39;</span><span class="p">,</span> <span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>avg_temp_F</th>
      <th>gravity</th>
      <th>moons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879.0</td>
      <td>167.0</td>
      <td>332.6</td>
      <td>3.7</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104.0</td>
      <td>464.0</td>
      <td>867.2</td>
      <td>8.9</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756.0</td>
      <td>15.0</td>
      <td>59.0</td>
      <td>9.8</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792.0</td>
      <td>-65.0</td>
      <td>-85.0</td>
      <td>3.7</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984.0</td>
      <td>-110.0</td>
      <td>-166.0</td>
      <td>23.1</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536.0</td>
      <td>-140.0</td>
      <td>-220.0</td>
      <td>9.0</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118.0</td>
      <td>-195.0</td>
      <td>-319.0</td>
      <td>8.7</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528.0</td>
      <td>-200.0</td>
      <td>-328.0</td>
      <td>11.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370.0</td>
      <td>-225.0</td>
      <td>-373.0</td>
      <td>0.7</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Moon</th>
      <td>3475.0</td>
      <td>-20.0</td>
      <td>-4.0</td>
      <td>1.6</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Using-numpy-functions">
<h3>Using numpy functions<a class="headerlink" href="#Using-numpy-functions" title="Permalink to this headline">¶</a></h3>
<p>Numpy functions can be be applied directly to pandas Series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diameters</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury      4879
Venus       12104
Earth       12756
Mars         6792
Jupyter    142984
Saturn     120536
Uranus      51118
Neptune     49528
Pluto        2370
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># take base 10 logarithm of each element of the Series</span>
<span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">diameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury    3.688331
Venus      4.082929
Earth      4.105715
Mars       3.831998
Jupyter    5.155287
Saturn     5.081117
Uranus     4.708574
Neptune    4.694851
Pluto      3.374748
dtype: float64
</pre></div></div>
</div>
<p>Since each row and each column of a DataFrame is a Series, we can use numpy functions to modify DataFrame rows and columns, or to create new rows and columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># create a new column with logarithms of diameters of planets</span>
<span class="n">planets</span><span class="p">[</span><span class="s2">&quot;log10_diameter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">planets</span><span class="p">[</span><span class="s2">&quot;diameter&quot;</span><span class="p">])</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>avg_temp_F</th>
      <th>gravity</th>
      <th>moons</th>
      <th>log10_diameter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879.0</td>
      <td>167.0</td>
      <td>332.6</td>
      <td>3.7</td>
      <td>0.0</td>
      <td>3.688331</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104.0</td>
      <td>464.0</td>
      <td>867.2</td>
      <td>8.9</td>
      <td>0.0</td>
      <td>4.082929</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756.0</td>
      <td>15.0</td>
      <td>59.0</td>
      <td>9.8</td>
      <td>1.0</td>
      <td>4.105715</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792.0</td>
      <td>-65.0</td>
      <td>-85.0</td>
      <td>3.7</td>
      <td>2.0</td>
      <td>3.831998</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984.0</td>
      <td>-110.0</td>
      <td>-166.0</td>
      <td>23.1</td>
      <td>79.0</td>
      <td>5.155287</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536.0</td>
      <td>-140.0</td>
      <td>-220.0</td>
      <td>9.0</td>
      <td>82.0</td>
      <td>5.081117</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118.0</td>
      <td>-195.0</td>
      <td>-319.0</td>
      <td>8.7</td>
      <td>27.0</td>
      <td>4.708574</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528.0</td>
      <td>-200.0</td>
      <td>-328.0</td>
      <td>11.0</td>
      <td>14.0</td>
      <td>4.694851</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370.0</td>
      <td>-225.0</td>
      <td>-373.0</td>
      <td>0.7</td>
      <td>5.0</td>
      <td>3.374748</td>
    </tr>
    <tr>
      <th>Moon</th>
      <td>3475.0</td>
      <td>-20.0</td>
      <td>-4.0</td>
      <td>1.6</td>
      <td>0.0</td>
      <td>3.540955</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Series.apply()">
<h3>Series.apply()<a class="headerlink" href="#Series.apply()" title="Permalink to this headline">¶</a></h3>
<p>More complex computations can be accomplished using the <code class="docutils literal notranslate"><span class="pre">apply</span></code> method of pandas Series. This method takes as its argument a function, applies this function to each value of the Series, and produces a new Series (or DataFrame) consisting of return values of the function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">get_size</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;big&quot;</span>
    <span class="k">elif</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;medium&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;small&quot;</span>

<span class="n">diameters</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mercury     small
Venus      medium
Earth      medium
Mars        small
Jupyter       big
Saturn        big
Uranus     medium
Neptune    medium
Pluto       small
dtype: object
</pre></div></div>
</div>
<p>Again, we can use this with any column or row of a DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># add new column with values of the size function applied</span>
<span class="c1"># to the diameter column</span>
<span class="n">planets</span><span class="p">[</span><span class="s2">&quot;planet_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">planets</span><span class="p">[</span><span class="s2">&quot;diameter&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_size</span><span class="p">)</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diameter</th>
      <th>avg_temp</th>
      <th>avg_temp_F</th>
      <th>gravity</th>
      <th>moons</th>
      <th>log10_diameter</th>
      <th>planet_size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mercury</th>
      <td>4879.0</td>
      <td>167.0</td>
      <td>332.6</td>
      <td>3.7</td>
      <td>0.0</td>
      <td>3.688331</td>
      <td>small</td>
    </tr>
    <tr>
      <th>Venus</th>
      <td>12104.0</td>
      <td>464.0</td>
      <td>867.2</td>
      <td>8.9</td>
      <td>0.0</td>
      <td>4.082929</td>
      <td>medium</td>
    </tr>
    <tr>
      <th>Earth</th>
      <td>12756.0</td>
      <td>15.0</td>
      <td>59.0</td>
      <td>9.8</td>
      <td>1.0</td>
      <td>4.105715</td>
      <td>medium</td>
    </tr>
    <tr>
      <th>Mars</th>
      <td>6792.0</td>
      <td>-65.0</td>
      <td>-85.0</td>
      <td>3.7</td>
      <td>2.0</td>
      <td>3.831998</td>
      <td>small</td>
    </tr>
    <tr>
      <th>Jupyter</th>
      <td>142984.0</td>
      <td>-110.0</td>
      <td>-166.0</td>
      <td>23.1</td>
      <td>79.0</td>
      <td>5.155287</td>
      <td>big</td>
    </tr>
    <tr>
      <th>Saturn</th>
      <td>120536.0</td>
      <td>-140.0</td>
      <td>-220.0</td>
      <td>9.0</td>
      <td>82.0</td>
      <td>5.081117</td>
      <td>big</td>
    </tr>
    <tr>
      <th>Uranus</th>
      <td>51118.0</td>
      <td>-195.0</td>
      <td>-319.0</td>
      <td>8.7</td>
      <td>27.0</td>
      <td>4.708574</td>
      <td>medium</td>
    </tr>
    <tr>
      <th>Neptune</th>
      <td>49528.0</td>
      <td>-200.0</td>
      <td>-328.0</td>
      <td>11.0</td>
      <td>14.0</td>
      <td>4.694851</td>
      <td>medium</td>
    </tr>
    <tr>
      <th>Pluto</th>
      <td>2370.0</td>
      <td>-225.0</td>
      <td>-373.0</td>
      <td>0.7</td>
      <td>5.0</td>
      <td>3.374748</td>
      <td>small</td>
    </tr>
    <tr>
      <th>Moon</th>
      <td>3475.0</td>
      <td>-20.0</td>
      <td>-4.0</td>
      <td>1.6</td>
      <td>0.0</td>
      <td>3.540955</td>
      <td>small</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="Aggregations">
<h2>Aggregations<a class="headerlink" href="#Aggregations" title="Permalink to this headline">¶</a></h2>
<p>Similarly as numpy arrays, pandas Series and DataFrames have several methods that let us summarize their data. We will use the following DataFrame with exam scores of some students to illustrate this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scores_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># create a dataframe</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores_arr</span><span class="p">,</span>                               <span class="c1"># data</span>
                      <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Emily&quot;</span><span class="p">],</span>  <span class="c1"># row names</span>
                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exam_1&quot;</span><span class="p">,</span> <span class="s2">&quot;exam_2&quot;</span><span class="p">,</span> <span class="s2">&quot;exam_3&quot;</span><span class="p">])</span>   <span class="c1"># column names</span>
<span class="n">scores</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>exam_1</th>
      <th>exam_2</th>
      <th>exam_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>John</th>
      <td>9</td>
      <td>69</td>
      <td>10</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>59</td>
      <td>53</td>
      <td>99</td>
    </tr>
    <tr>
      <th>Bob</th>
      <td>15</td>
      <td>48</td>
      <td>16</td>
    </tr>
    <tr>
      <th>Emily</th>
      <td>59</td>
      <td>22</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># compute maximum of each column</span>
<span class="n">scores</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
exam_1    59
exam_2    69
exam_3    99
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># compute minimum of each column</span>
<span class="n">scores</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
exam_1     9
exam_2    22
exam_3    10
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># compute average value of each column</span>
<span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
exam_1    35.5
exam_2    48.0
exam_3    38.0
dtype: float64
</pre></div></div>
</div>
<p>By default, aggregations are computed for each column, but we can change it using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># compute sum of each row</span>
<span class="n">scores</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
John      88
Alice    211
Bob       79
Emily    108
dtype: int64
</pre></div></div>
</div>
<div class="section" id="DataFrame.agg()">
<h3>DataFrame.agg()<a class="headerlink" href="#DataFrame.agg()" title="Permalink to this headline">¶</a></h3>
<p>To aggregate data in a custom way we can use the DataFrame <code class="docutils literal notranslate"><span class="pre">agg</span></code> method. This method takes as an argument a function, passes each column (or row) of the DataFrame to this function, and returns a Series (or DataFrame) consisting of return values.</p>
<p>For example, lets say that we want to assign grades to students based on their total exam scores: “Pass” for a score above 200, and “Fail” otherwise. We can do it as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">assign_grades</span><span class="p">(</span><span class="n">scores</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Pass&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Fail&quot;</span>

<span class="n">scores</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">assign_grades</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
John     Fail
Alice    Pass
Bob      Fail
Emily    Fail
dtype: object
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">agg</span></code> method has several additional options. For example, we can use it to specify a different aggregation function for each column.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># compute minumum of exam_1, maximum of exam_2 and mean of exam_3</span>
<span class="n">scores</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;exam_1&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;exam_2&quot;</span> <span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;exam_3&quot;</span> <span class="p">:</span> <span class="s2">&quot;mean&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
exam_1     9.0
exam_2    69.0
exam_3    38.0
dtype: float64
</pre></div></div>
</div>
<p>Notice that the standard aggregation functions (<code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code> etc.) can be specified by giving their names as strings.</p>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">agg</span></code> with a list of functions to compute several aggregations at once:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># compute mean, sum, and the value of assign_grades for each row</span>
<span class="n">scores</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">assign_grades</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sum</th>
      <th>assign_grades</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>John</th>
      <td>29.3333</td>
      <td>88</td>
      <td>Fail</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>70.3333</td>
      <td>211</td>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Bob</th>
      <td>26.3333</td>
      <td>79</td>
      <td>Fail</td>
    </tr>
    <tr>
      <th>Emily</th>
      <td>36</td>
      <td>108</td>
      <td>Fail</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="reshaping_dataframes.html" class="btn btn-neutral float-right" title="Reshaping DataFrames" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pandas_toc.html" class="btn btn-neutral float-left" title="Pandas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width: 100px; border-width:0" src="https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg" /></a>  <a href="mailto:admin@mth548.org">Bernard Badzioch</a>
      <span class="lastupdated"><br/>
        Last updated on Jun 12, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-161474487-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>